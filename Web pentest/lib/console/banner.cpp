#include "../../include/console/banner.h"

void show_banner(){
	const char* BANNER = R"BANNER(
	             .-') _                              .-')
	           (  OO) )                            ( OO ).
	 ,--. ,--.  /     '._ ,-.-')  ,--.      ,-.-') (_)---\_)
	 |  | |  |  |'--...__)|  |OO) |  |.-')  |  |OO)/    _ |
	 |  | | .-')'--.  .--'|  |  \ |  | OO ) |  |  \\  :` `.
	 |  |_|( OO )  |  |   |  |(_/ |  |`-' | |  |(_/ '..`''.)
	 |  | | `-' /  |  |  ,|  |_.'(|  '---.',|  |_.'.-._)   \
	('  '-'(_.-'   |  | (_|  |    |      |(_|  |   \       /
	 `-----'      `--'    `--'    `------'  `--'    `-----'

[1] Automatic Information Gathering
[2] Webapp Exploitation
[3] DOS Attack)BANNER";

	print(BANNER, 3);
}

void run_console(){
	unsigned short int value = 0;

	system(CLEAR_SCREEN);
	show_banner();
	print_without_new_line(NEW_LINE,2);
	print_without_new_line("[*] saman!> ",2);
	std::cin >> value;
	switch(value){
		case 1: information_auto_call(); break;
		case 2: webapp_exploitation(); break;
		case 3: dos(); break;
		default: print("Invalid Choice!!",1);break;
	}
}
void information_auto_call(){
	short int depth = 0;
	std::string hostname;
	print_without_new_line("[*] Hostname (Enter hostname by comma separated if you have more "
				   "than one Hostname e.g.: google.com,120.0.0.1) :: ",4);
	std::cin >> hostname;
	print_without_new_line("[*] Enter the Depth By which to search the Network (default:0):: ", 4);
	std::cin >> depth;

	if (depth < 0){
		depth *= -1;
	}
	if (depth > 2){
		print("[+] Depth can't be more than 2 setting depth=2",2);
		depth = 2;
	}

	information_auto(hostname,depth);
}

void webapp_exploitation(){
	std::string hostname;
	print_without_new_line("[*] Hostname (Enter hostname by comma separated if you have more"
					   "than one Hostname e.g.: www.google.com,127.0.0.1) :: ",4);
	std::cin >> hostname;
	web_exploit(hostname,80);
}
void dos(){
	std::string hostname;
	print_without_new_line("[*] Hostname (Enter hostname by comma separated if you have more"
						   "than one Hostname e.g.: www.google.com,127.0.0.1) :: ",4);
	std::cin >> hostname;
	dos_attack(hostname,80);
}
