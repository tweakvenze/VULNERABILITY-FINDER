#include "../../include/exploit/sql_injection.h"

void SQL_FILTER(std::string &result){
	print (result, 5);
}

void sql_map(std::string &hostname,int PORT_NUMBER, int THREADS){
	std::string command, result, filename, path = "/xss/example1.php?name=hacker";
	Sock *sqlmap_sock = new Sock(hostname, PORT_NUMBER);
	sqlmap_sock->sendrequest(path, result);

	filename = Save_LOCATION + hostname;
	filename += (std::string)"-sqlmap" + (std::string) FILE_EXTENSION;
	print(filename);

	std::ofstream fout(filename);
	fout << result;
	fout.close();
	print ("SQLMAP running....", 4);
	command = SQLMAP_LOCATION + (std::string)"-r " +filename + sql_map_query[2] ;
	result = system(command.c_str());
	SQL_FILTER(result);
	print (command);
	result.erase();
}

